{% extends 'layouts/base.html' %}
{% block title %} Analytics {% endblock title %}

{% block stylesheets %}
<style>
  .metric-card {
    transition: all 0.3s ease;
  }
  .metric-card:hover {
    transform: scale(1.02);
  }
  .chart-container {
    position: relative;
    height: 300px;
  }
  .implication-box { background: linear-gradient(to right, rgba(203,12,159,0.05), rgba(94,114,228,0.05)); border-radius: 8px; padding: 12px; margin-top: 8px; }
  .metric-explanation { background: linear-gradient(to right, rgba(17,205,239,0.05), rgba(45,206,137,0.05)); border-radius: 8px; padding: 10px; }
</style>
{% endblock stylesheets %}

{% block content %}
<div class="container-fluid py-4">
  <!-- Page Header Overview -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card bg-gradient-primary">
        <div class="card-body p-4">
          <h4 class="text-white mb-1"><i class="fas fa-chart-bar me-2"></i>Your Trading Report Card</h4>
          <p class="text-white opacity-8 mb-0">Numbers don't lie - here's exactly how your strategies are performing. Use these metrics to identify what's working (do more of it) and what isn't (fix or remove it).</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Page Header with Filters -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-body p-3">
          <div class="row align-items-center">
            <div class="col-lg-4">
              <h5 class="mb-0"><i class="fas fa-filter me-2"></i>Filter Analytics</h5>
            </div>
            <div class="col-lg-8">
              <div class="row">
                <div class="col-md-4 mb-2 mb-md-0">
                  <select class="form-select" id="strategyFilter">
                    <option value="all">All Strategies</option>
                    <option value="wsb-dip-bot">WSB Dip Bot</option>
                    <option value="momentum-weeklies">Momentum Weeklies</option>
                    <option value="wheel-strategy">Wheel Strategy</option>
                    <option value="swing-trading">Swing Trading</option>
                  </select>
                </div>
                <div class="col-md-4 mb-2 mb-md-0">
                  <input type="date" class="form-control" id="startDate">
                </div>
                <div class="col-md-4">
                  <input type="date" class="form-control" id="endDate">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Key Metrics Row -->
  <div class="row mb-4">
    <div class="col-xl-2 col-md-4 col-6 mb-xl-0 mb-4">
      <div class="card metric-card" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Your total realized profit/loss across all trades. This is the bottom line - everything else leads to this number.">
        <div class="card-body p-3 text-center">
          <h3 class="{% if metrics.total_pnl >= 0 %}text-success{% else %}text-danger{% endif %} mb-0">{% if metrics.total_pnl >= 0 %}+{% endif %}${{ metrics.total_pnl|floatformat:0|default:"12,450" }}</h3>
          <p class="text-sm text-secondary mb-0">Total P&L <i class="fas fa-info-circle text-secondary opacity-6"></i></p>
        </div>
      </div>
    </div>
    <div class="col-xl-2 col-md-4 col-6 mb-xl-0 mb-4">
      <div class="card metric-card" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Percentage of trades that made money. 50% = break-even, 60% = good, 70%+ = excellent. But win rate alone doesn't tell the whole story - a 40% win rate can still be profitable if winners are much bigger than losers!">
        <div class="card-body p-3 text-center">
          <h3 class="text-info mb-0">{{ metrics.win_rate|floatformat:1|default:"68.5" }}%</h3>
          <p class="text-sm text-secondary mb-0">Win Rate <i class="fas fa-info-circle text-secondary opacity-6"></i></p>
          <span class="badge bg-gradient-success text-xs mt-1">Above Average</span>
        </div>
      </div>
    </div>
    <div class="col-xl-2 col-md-4 col-6 mb-xl-0 mb-4">
      <div class="card metric-card" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Average winning trade size divided by average losing trade size. 2.3:1 means your winners are 2.3x bigger than your losers. Combined with win rate, this determines profitability.">
        <div class="card-body p-3 text-center">
          <h3 class="mb-0">{{ metrics.win_loss_ratio|floatformat:1|default:"2.3" }}:1</h3>
          <p class="text-sm text-secondary mb-0">Win/Loss Ratio <i class="fas fa-info-circle text-secondary opacity-6"></i></p>
          <span class="badge bg-gradient-info text-xs mt-1">>1.5 is Good</span>
        </div>
      </div>
    </div>
    <div class="col-xl-2 col-md-4 col-6 mb-xl-0 mb-4">
      <div class="card metric-card" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Your single most profitable trade. It's nice to celebrate winners, but don't chase this feeling - consistency beats home runs.">
        <div class="card-body p-3 text-center">
          <h3 class="text-success mb-0">+${{ metrics.best_trade|floatformat:0|default:"892" }}</h3>
          <p class="text-sm text-secondary mb-0">Best Trade <i class="fas fa-info-circle text-secondary opacity-6"></i></p>
        </div>
      </div>
    </div>
    <div class="col-xl-2 col-md-4 col-6 mb-xl-0 mb-4">
      <div class="card metric-card" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Your biggest loss. If this is way larger than your best trade, your risk management might need adjustment. Ideally, worst loss should be similar to or smaller than best win.">
        <div class="card-body p-3 text-center">
          <h3 class="text-danger mb-0">${{ metrics.worst_trade|floatformat:0|default:"-345" }}</h3>
          <p class="text-sm text-secondary mb-0">Worst Trade <i class="fas fa-info-circle text-secondary opacity-6"></i></p>
        </div>
      </div>
    </div>
    <div class="col-xl-2 col-md-4 col-6">
      <div class="card metric-card" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Total number of completed trades. More trades = more statistically significant results. Generally need 30+ trades for meaningful analysis.">
        <div class="card-body p-3 text-center">
          <h3 class="mb-0">{{ metrics.total_trades|default:"156" }}</h3>
          <p class="text-sm text-secondary mb-0">Total Trades <i class="fas fa-info-circle text-secondary opacity-6"></i></p>
          <span class="badge bg-gradient-success text-xs mt-1">Significant</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Key Metrics Explanation -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="implication-box">
        <div class="row">
          <div class="col-md-4">
            <h6 class="text-sm mb-1"><i class="fas fa-chart-line text-success me-1"></i>The Formula for Profit</h6>
            <p class="text-xs text-secondary mb-0">(Win Rate x Avg Win) - (Loss Rate x Avg Loss) = Your Edge. Your numbers show a solid edge!</p>
          </div>
          <div class="col-md-4">
            <h6 class="text-sm mb-1"><i class="fas fa-balance-scale text-info me-1"></i>What Matters Most</h6>
            <p class="text-xs text-secondary mb-0">Win Rate alone is misleading. A 30% win rate with 5:1 reward/risk beats a 70% win rate with 0.5:1.</p>
          </div>
          <div class="col-md-4">
            <h6 class="text-sm mb-1"><i class="fas fa-shield-alt text-warning me-1"></i>Compare Best vs Worst</h6>
            <p class="text-xs text-secondary mb-0">If your worst trade is bigger than your best, you're not cutting losses fast enough. Review your exit rules.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row mb-4">
    <!-- Cumulative Returns Chart -->
    <div class="col-lg-8 mb-lg-0 mb-4">
      <div class="card">
        <div class="card-header pb-0">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="mb-0">Cumulative Returns</h6>
              <p class="text-xs text-secondary mb-0">Your equity curve - a rising line means you're making money over time</p>
            </div>
            <div>
              <button class="btn btn-sm btn-outline-primary mb-0 active">Strategy</button>
              <button class="btn btn-sm btn-outline-secondary mb-0">vs SPY</button>
            </div>
          </div>
        </div>
        <div class="card-body p-3">
          <div class="chart-container">
            <canvas id="cumulativeReturnsChart"></canvas>
          </div>
          <div class="metric-explanation mt-2">
            <small class="text-secondary"><i class="fas fa-info-circle text-info me-1"></i><strong>What to look for:</strong> Steady upward slope is ideal. Compare to SPY - if your line is above SPY, you're beating the market. Big dips = drawdowns, the smaller the better.</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Win/Loss Distribution -->
    <div class="col-lg-4">
      <div class="card h-100">
        <div class="card-header pb-0">
          <h6 class="mb-0">Win/Loss Distribution</h6>
          <p class="text-xs text-secondary mb-0">Quick visual of your success rate</p>
        </div>
        <div class="card-body p-3">
          <div class="chart-container">
            <canvas id="winLossChart"></canvas>
          </div>
          <div class="metric-explanation mt-2">
            <small class="text-secondary"><i class="fas fa-trophy text-success me-1"></i>You're winning more than losing! Combined with a good win/loss ratio, this is a profitable setup.</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Second Charts Row -->
  <div class="row mb-4">
    <!-- P&L by Strategy -->
    <div class="col-lg-6 mb-lg-0 mb-4">
      <div class="card">
        <div class="card-header pb-0">
          <h6 class="mb-0">P&L by Strategy</h6>
          <p class="text-xs text-secondary mb-0">Which strategies are making you money?</p>
        </div>
        <div class="card-body p-3">
          <div class="chart-container">
            <canvas id="pnlByStrategyChart"></canvas>
          </div>
          <div class="metric-explanation mt-2">
            <small class="text-secondary"><i class="fas fa-lightbulb text-warning me-1"></i><strong>Pro tip:</strong> Consider allocating more capital to your best-performing strategies. If a strategy is consistently losing, review or disable it.</small>
          </div>
        </div>
      </div>
    </div>

    <!-- P&L by Day of Week -->
    <div class="col-lg-6">
      <div class="card">
        <div class="card-header pb-0">
          <h6 class="mb-0">P&L by Day of Week</h6>
          <p class="text-xs text-secondary mb-0">Are some days better than others?</p>
        </div>
        <div class="card-body p-3">
          <div class="chart-container">
            <canvas id="pnlByDayChart"></canvas>
          </div>
          <div class="metric-explanation mt-2">
            <small class="text-secondary"><i class="fas fa-calendar text-primary me-1"></i><strong>What this means:</strong> Fridays are often best (weekend positions), Mondays can be volatile. If one day is consistently bad, consider reducing activity on that day.</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Detailed Analytics Tabs -->
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header pb-0">
          <ul class="nav nav-tabs" id="analyticsTabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="by-strategy-tab" data-bs-toggle="tab" href="#byStrategy" role="tab">By Strategy</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="by-symbol-tab" data-bs-toggle="tab" href="#bySymbol" role="tab">By Symbol</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="by-time-tab" data-bs-toggle="tab" href="#byTime" role="tab">By Time</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="risk-metrics-tab" data-bs-toggle="tab" href="#riskMetrics" role="tab">Risk Metrics</a>
            </li>
          </ul>
        </div>
        <div class="card-body">
          <div class="tab-content" id="analyticsTabContent">
            <!-- By Strategy Tab -->
            <div class="tab-pane fade show active" id="byStrategy" role="tabpanel">
              <div class="table-responsive">
                <table class="table align-items-center mb-0">
                  <thead>
                    <tr>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Strategy</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Trades</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Win Rate</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">P&L</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Sharpe</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Max DD</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><span class="font-weight-bold">WSB Dip Bot</span></td>
                      <td class="text-center">45</td>
                      <td class="text-center">71%</td>
                      <td class="text-center text-success">+$4,250</td>
                      <td class="text-center">1.85</td>
                      <td class="text-center text-danger">-3.2%</td>
                    </tr>
                    <tr>
                      <td><span class="font-weight-bold">Momentum Weeklies</span></td>
                      <td class="text-center">32</td>
                      <td class="text-center">62%</td>
                      <td class="text-center text-success">+$2,890</td>
                      <td class="text-center">1.42</td>
                      <td class="text-center text-danger">-5.1%</td>
                    </tr>
                    <tr>
                      <td><span class="font-weight-bold">Wheel Strategy</span></td>
                      <td class="text-center">28</td>
                      <td class="text-center">85%</td>
                      <td class="text-center text-success">+$3,120</td>
                      <td class="text-center">2.15</td>
                      <td class="text-center text-danger">-2.1%</td>
                    </tr>
                    <tr>
                      <td><span class="font-weight-bold">Swing Trading</span></td>
                      <td class="text-center">51</td>
                      <td class="text-center">58%</td>
                      <td class="text-center text-success">+$2,190</td>
                      <td class="text-center">1.25</td>
                      <td class="text-center text-danger">-4.8%</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- By Symbol Tab -->
            <div class="tab-pane fade" id="bySymbol" role="tabpanel">
              <div class="table-responsive">
                <table class="table align-items-center mb-0">
                  <thead>
                    <tr>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Symbol</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Trades</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Win Rate</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Total P&L</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Avg P&L</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><span class="font-weight-bold">AAPL</span></td>
                      <td class="text-center">18</td>
                      <td class="text-center">72%</td>
                      <td class="text-center text-success">+$1,850</td>
                      <td class="text-center text-success">+$102</td>
                    </tr>
                    <tr>
                      <td><span class="font-weight-bold">TSLA</span></td>
                      <td class="text-center">15</td>
                      <td class="text-center">60%</td>
                      <td class="text-center text-success">+$2,340</td>
                      <td class="text-center text-success">+$156</td>
                    </tr>
                    <tr>
                      <td><span class="font-weight-bold">NVDA</span></td>
                      <td class="text-center">22</td>
                      <td class="text-center">68%</td>
                      <td class="text-center text-success">+$3,120</td>
                      <td class="text-center text-success">+$142</td>
                    </tr>
                    <tr>
                      <td><span class="font-weight-bold">MSFT</span></td>
                      <td class="text-center">12</td>
                      <td class="text-center">75%</td>
                      <td class="text-center text-success">+$980</td>
                      <td class="text-center text-success">+$82</td>
                    </tr>
                    <tr>
                      <td><span class="font-weight-bold">AMD</span></td>
                      <td class="text-center">10</td>
                      <td class="text-center">50%</td>
                      <td class="text-center text-danger">-$240</td>
                      <td class="text-center text-danger">-$24</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- By Time Tab -->
            <div class="tab-pane fade" id="byTime" role="tabpanel">
              <div class="row">
                <div class="col-md-6">
                  <h6 class="text-sm">Performance by Hour</h6>
                  <div class="table-responsive">
                    <table class="table table-sm">
                      <tbody>
                        <tr><td>9:30 - 10:00</td><td class="text-success">+$1,240</td></tr>
                        <tr><td>10:00 - 11:00</td><td class="text-success">+$890</td></tr>
                        <tr><td>11:00 - 12:00</td><td class="text-danger">-$120</td></tr>
                        <tr><td>12:00 - 13:00</td><td class="text-success">+$340</td></tr>
                        <tr><td>13:00 - 14:00</td><td class="text-success">+$560</td></tr>
                        <tr><td>14:00 - 15:00</td><td class="text-success">+$780</td></tr>
                        <tr><td>15:00 - 16:00</td><td class="text-success">+$1,120</td></tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class="col-md-6">
                  <h6 class="text-sm">Performance by Month</h6>
                  <div class="table-responsive">
                    <table class="table table-sm">
                      <tbody>
                        <tr><td>January</td><td class="text-success">+$2,340</td></tr>
                        <tr><td>February</td><td class="text-success">+$1,890</td></tr>
                        <tr><td>March</td><td class="text-danger">-$450</td></tr>
                        <tr><td>April</td><td class="text-success">+$3,120</td></tr>
                        <tr><td>May</td><td class="text-success">+$2,780</td></tr>
                        <tr><td>June</td><td class="text-success">+$2,770</td></tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>

            <!-- Risk Metrics Tab -->
            <div class="tab-pane fade" id="riskMetrics" role="tabpanel">
              <div class="row">
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0">{{ metrics.sharpe_ratio|floatformat:2|default:"1.72" }}</h4>
                    <p class="text-sm text-secondary mb-0">Sharpe Ratio</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-info-circle text-info me-1"></i><strong>What it means:</strong> Return per unit of risk. >1.0 is good, >2.0 is excellent. You're getting {{ metrics.sharpe_ratio|floatformat:2|default:"1.72" }}x return for each unit of volatility you're taking.</small>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0">{{ metrics.sortino_ratio|floatformat:2|default:"2.15" }}</h4>
                    <p class="text-sm text-secondary mb-0">Sortino Ratio</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-info-circle text-success me-1"></i><strong>What it means:</strong> Like Sharpe but only penalizes downside volatility. Higher than Sharpe = your upside moves are bigger than downside. {{ metrics.sortino_ratio|floatformat:2|default:"2.15" }} is excellent!</small>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0 text-danger">{{ metrics.max_drawdown|floatformat:1|default:"-6.2" }}%</h4>
                    <p class="text-sm text-secondary mb-0">Max Drawdown</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-exclamation-triangle text-warning me-1"></i><strong>What it means:</strong> Largest peak-to-trough decline. {{ metrics.max_drawdown|floatformat:1|default:"-6.2" }}% means at worst, you were down that much from your highest point. Under -10% is generally acceptable.</small>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0">{{ metrics.beta|floatformat:2|default:"1.15" }}</h4>
                    <p class="text-sm text-secondary mb-0">Beta</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-chart-line text-primary me-1"></i><strong>What it means:</strong> How much you move vs the market. {{ metrics.beta|floatformat:2|default:"1.15" }} = that much more volatile than SPY. When market goes up 1%, you go up ~{{ metrics.beta|floatformat:2|default:"1.15" }}%.</small>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0 text-success">+{{ metrics.alpha|floatformat:1|default:"4.2" }}%</h4>
                    <p class="text-sm text-secondary mb-0">Alpha</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-trophy text-success me-1"></i><strong>What it means:</strong> Excess return beyond what beta explains. +{{ metrics.alpha|floatformat:1|default:"4.2" }}% alpha = you're beating the market by that much on a risk-adjusted basis. This is your "edge"!</small>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0">{{ metrics.r_squared|floatformat:2|default:"0.85" }}</h4>
                    <p class="text-sm text-secondary mb-0">R-Squared</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-link text-secondary me-1"></i><strong>What it means:</strong> How correlated you are to the market. {{ metrics.r_squared|floatformat:2|default:"0.85" }} = that % of your returns are explained by market moves. Lower = more independent strategy.</small>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0">{{ metrics.volatility|floatformat:1|default:"18.5" }}%</h4>
                    <p class="text-sm text-secondary mb-0">Volatility</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-wave-square text-warning me-1"></i><strong>What it means:</strong> Annualized standard deviation of returns. {{ metrics.volatility|floatformat:1|default:"18.5" }}% is moderate - you can expect daily swings of ~1.2%. SPY is typically 15-20%.</small>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div class="border rounded p-3 text-center">
                    <h4 class="mb-0">{{ metrics.profit_factor|floatformat:1|default:"1.8" }}</h4>
                    <p class="text-sm text-secondary mb-0">Profit Factor</p>
                  </div>
                  <div class="metric-explanation mt-2">
                    <small class="text-secondary"><i class="fas fa-dollar-sign text-success me-1"></i><strong>What it means:</strong> Gross profits / gross losses. {{ metrics.profit_factor|floatformat:1|default:"1.8" }} = you make ${{ metrics.profit_factor|floatformat:2|default:"1.80" }} for every $1 you lose. >1.5 is good, >2.0 is excellent. Simple but powerful metric!</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="card-footer">
          <div class="d-flex justify-content-between">
            <button class="btn btn-outline-primary mb-0">
              <i class="fas fa-file-pdf me-2"></i>Export PDF
            </button>
            <button class="btn btn-outline-info mb-0">
              <i class="fas fa-file-csv me-2"></i>Export CSV
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% include "includes/footer.html" %}
</div>
{% endblock content %}

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Cumulative Returns Chart
  const ctx1 = document.getElementById('cumulativeReturnsChart').getContext('2d');
  new Chart(ctx1, {
    type: 'line',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
      datasets: [{
        label: 'Strategy',
        data: [0, 2.3, 4.1, 3.5, 6.8, 8.2, 9.5, 11.2, 10.8, 12.1, 14.5, 15.8],
        borderColor: '#cb0c9f',
        backgroundColor: 'rgba(203, 12, 159, 0.1)',
        fill: true,
        tension: 0.4
      }, {
        label: 'SPY',
        data: [0, 1.5, 2.8, 3.2, 4.5, 5.1, 5.8, 6.2, 5.9, 7.1, 8.2, 9.5],
        borderColor: '#3A416F',
        backgroundColor: 'rgba(58, 65, 111, 0.1)',
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'top' } },
      scales: { y: { ticks: { callback: value => value + '%' } } }
    }
  });

  // Win/Loss Distribution Chart
  const ctx2 = document.getElementById('winLossChart').getContext('2d');
  new Chart(ctx2, {
    type: 'doughnut',
    data: {
      labels: ['Wins', 'Losses'],
      datasets: [{
        data: [107, 49],
        backgroundColor: ['#2dce89', '#f5365c'],
        borderWidth: 0
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'bottom' } }
    }
  });

  // P&L by Strategy Chart
  const ctx3 = document.getElementById('pnlByStrategyChart').getContext('2d');
  new Chart(ctx3, {
    type: 'bar',
    data: {
      labels: ['WSB Dip Bot', 'Momentum Weeklies', 'Wheel Strategy', 'Swing Trading', 'Credit Spreads'],
      datasets: [{
        label: 'P&L ($)',
        data: [4250, 2890, 3120, 2190, 1800],
        backgroundColor: ['#cb0c9f', '#2dce89', '#11cdef', '#fb6340', '#f5365c']
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      indexAxis: 'y',
      plugins: { legend: { display: false } }
    }
  });

  // P&L by Day Chart
  const ctx4 = document.getElementById('pnlByDayChart').getContext('2d');
  new Chart(ctx4, {
    type: 'bar',
    data: {
      labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
      datasets: [{
        label: 'P&L ($)',
        data: [1850, 2340, 980, 3120, 4160],
        backgroundColor: '#cb0c9f'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } }
    }
  });

  // Initialize tooltips
  var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
  var tooltipList = tooltipTriggerList.map(function(tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl);
  });
</script>
{% endblock javascripts %}
